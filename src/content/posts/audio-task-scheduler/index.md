---
title: Windows æ–­å¼€è“ç‰™è€³æœºæ—¶è‡ªåŠ¨é™éŸ³
published: 2024-06-12
description: 'ç”¨ä»»åŠ¡è®¡åˆ’åˆ›å»ºè“ç‰™è¿æ¥ä»»åŠ¡æ§åˆ¶ç³»ç»Ÿå£°éŸ³è¾“å‡º'
image: '../covers/B20BDD6FED01BB832F7635115797C2A5.jpg'
tags: [task-scheduler, windows, bluetooth]
category: 'Life'
draft: false 
---

## å‰è¨€

ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„å°´å°¬ï¼Œåœ¨å…¬å…±åœºåˆæ‰“å¼€ç¬”è®°æœ¬ï¼Œä»¥ä¸ºè¿ä¸Šè€³æœºå…¶å®æ²¡è¿ä¸Šå·å·æ‘¸é±¼è¢«å‘ç°ï¼Œåˆæˆ–è€…è€³æœºæ–­å¼€åç”µè„‘éŸ³é¢‘å¤§å£°æ’­æ”¾ï¼Œåˆåˆæˆ–è€…æŠ•å±åˆ°å¤§å±æ—¶åå°çš„éŸ³é¢‘å¼€å§‹æ’­æ”¾å‘å‡ºå£°éŸ³ï¼Œå¦‚æ­¤å¦‚æ­¤è¿™èˆ¬è¿™èˆ¬ç­‰ç­‰è¿™ç±»çš„åœºæ™¯ï¼Œ  
å¦‚æœä½ ä¹Ÿé‡åˆ°è¿‡ï¼Œå¹¶å¯¹æ­¤è‹¦æ¼ï¼Œæ¬¢è¿ç»§ç»­å¾€åçœ‹è§£å†³æ–¹æ³•ï¼Œ  
æ²¡é‡åˆ°ä¹Ÿæ²¡å…³ç³»ï¼Œæœ€è¿‘å‡ å¤©æˆ‘ä¸çŸ¥é“è§¦äº†ä»€ä¹ˆéœ‰å¤´ï¼Œå…¨éƒ½èµ¶ä¸Šäº†ï¼Œç°åœ¨ä½ å¯ä»¥ç¬‘ä¸€ç¬‘ï¼Œç„¶åæ»šå‡ºè¿™ä¸ªé¡µé¢äº†

![](../meme/xlsi.png)

## ä»»åŠ¡è®¡åˆ’

è§£å†³æ–¹æ³•çš„æ€è·¯æ˜¯ï¼šåœ¨è“ç‰™è®¾å¤‡è¿æ¥æ—¶å…è®¸æ’­æ”¾éŸ³é¢‘ï¼Œåœ¨æ–­å¼€/æ²¡æœ‰è¿æ¥æ—¶è‡ªåŠ¨è®¾ç½®ä¸ºé™éŸ³ã€‚è¿™ä¸ªè‡ªåŠ¨åŒ–çš„è¿‡ç¨‹äº¤ç»™ Windows ä¸Šçš„**ä»»åŠ¡è®¡åˆ’æ‰§è¡Œ**ã€‚

æŒ‰ `Win` æœç´¢ã€Œäº‹ä»¶æŸ¥çœ‹å™¨ã€é¢æ¿ï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°è“ç‰™è¿æ¥ä¸æ–­å¼€çš„äº‹ä»¶ä½œä¸ºè§¦å‘å™¨ï¼ˆtriggerï¼‰ï¼Œæˆ‘æœç´¢ä¸€åœˆæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªäº‹ä»¶ï¼Œä¸è¿‡åœ¨[ä¸€ä¸ªå¸–å­](https://forum.vb-audio.com/viewtopic.php?t=590)çš„æˆªå›¾ä¸Šå‘ç°äº†ç›´æ¥ç›¸å…³çš„äº‹ä»¶ï¼šWindows çš„éŸ³é¢‘æ“ä½œäº‹ä»¶ï¼Œè·¯å¾„æ˜¯ `äº‹ä»¶æŸ¥çœ‹å™¨ => åº”ç”¨ç¨‹åºå’ŒæœåŠ¡æ—¥å¿— => Microsoft => Windows => Audio => Operational`ã€‚

è¿™ä¸ªäº‹ä»¶åœ¨éŸ³é¢‘è®¾å¤‡å˜åŒ–æ—¶å°±ä¼šè§¦å‘ï¼Œä¹Ÿå°±æ˜¯æ— è®ºè¿æ¥è¿˜æ˜¯æ–­å¼€ï¼Œè§¦å‘çš„æ˜¯åŒä¸€ä¸ªäº‹ä»¶ï¼Œä¸é¢„æœŸçš„ä¸ä¸€æ ·ä½†æ˜¯æ²¡å…³ç³»ï¼Œä¹‹ååˆ¤æ–­ä¸€ä¸‹å½“å‰ä½¿ç”¨çš„è®¾å¤‡å°±è¡Œäº†ã€‚å…ˆæŠŠä»»åŠ¡è®¡åˆ’åŠ ä¸Šï¼Œé€‰æ‹©å³è¾¹é¢æ¿çš„ã€Œå°†ä»»åŠ¡é™„åŠ åˆ°æ­¤äº‹ä»¶ã€ï¼Œè¿™ä¸ªå¯ä»¥å¸®æˆ‘ä»¬æ ¹æ®äº‹ä»¶è‡ªåŠ¨å¡«å†™ä»»åŠ¡è®¡åˆ’çš„è§¦å‘ä¿¡æ¯ã€‚åœ¨æ“ä½œé€‰æ‹©è¿è¡Œç¨‹åºï¼Œä¹‹åçš„åˆ¤æ–­é€»è¾‘å’Œé™éŸ³æ“ä½œä½¿ç”¨ Powershell å†™ä¸ªè„šæœ¬å®ç°ï¼Œ  
æ‰€ä»¥è¿™é‡Œç¨‹åºå¡« `powershell.exe`ï¼Œ  
å‚æ•°å¡« `-NoProfile -ExecutionPolicy Bypass -File "path\to\file"`ï¼Œæ–‡ä»¶è·¯å¾„æ”¹æˆä½ è‡ªå·±çš„ï¼Œ  
ä¹‹ååœ¨é‚£é‡Œå»ºä¸€ä¸ª ps1 åç¼€çš„è„šæœ¬æ–‡ä»¶

![alt text](image.png)

## æ ¹æ®éŸ³é¢‘è®¾å¤‡è®¾ç½®éŸ³é‡

é¦–å…ˆæ˜¯è·å–å½“å‰çš„éŸ³é¢‘è®¾å¤‡ï¼Œå¯ä»¥å®‰è£…ä¸€ä¸ªæ¨¡å— `AudioDeviceCmdlets` å®ç°

å¤šä¸ªè®¾å¤‡åå­—ç”¨ `|` åˆ†éš”ï¼Œè¿™ä¸ª TWS-F9 æ˜¯æˆ‘è€³æœºçš„åå­—ï¼Œè®°å¾—æ›¿æ¢

```bash
# å®‰è£…æ¨¡å—
Install-Module -Name AudioDeviceCmdlets -Force
```

```powershell
# å¯¼å…¥æ¨¡å—
Import-Module AudioDeviceCmdlets
# è·å–å½“å‰éŸ³é¢‘è®¾å¤‡å
$currentDevice = Get-AudioDevice -Playback
$deviceName = $currentDevice.Name
if ($deviceName -match "Bluetooth|TWS-F9"){
    ...
}
```

ç„¶åè°ƒæ•´éŸ³é‡ Powershell è‡ªå¸¦çš„å‘½ä»¤å¥½åƒä¸å¥½æ—¶ï¼Œæˆ‘æ‰¾äº†ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…· NirCmdã€‚ä¸‹è½½ï¼š[nircmd-x64.zip](https://www.nirsoft.net/utils/nircmd-x64.zip)ï¼Œä¹‹åæ‰”åˆ°ç¯å¢ƒå˜é‡é‡Œ

ä½¿ç”¨çš„å‘½ä»¤åªæœ‰ä¸¤ç§ï¼Œè®¾ç½®éŸ³é‡å¤§å°å’Œè®¾ç½®é™éŸ³ï¼Œå¤§æ¦‚è¿™æ ·

```powershell

if ($deviceName -match "Bluetooth|TWS-F9"){
    & "nircmd.exe" setsysvolume 0 # max-value 65535
}else{
    & "nircmd.exe" mutesysvolume 1
}
```

<details>
  <summary>æˆ‘çš„å®Œæ•´ä»£ç </summary>

```powershell
& "nircmd.exe" setsysvolume 0
& "nircmd.exe" mutesysvolume 1

# Install-Module -Name AudioDeviceCmdlets -Force
# Import the module    
Import-Module AudioDeviceCmdlets

# è·å–å½“å‰é»˜è®¤çš„æ’­æ”¾è®¾å¤‡
$currentDevice = Get-AudioDevice -Playback
$deviceName = $currentDevice.Name

# åˆ¤æ–­è®¾å¤‡ç±»å‹å¹¶è®¾ç½®éŸ³é‡
if ($deviceName -match "Bluetooth|TWS-F9") {
    $deviceType = "è“ç‰™è®¾å¤‡"
    & "nircmd.exe" setsysvolume 6553 # max 65535
} elseif ($deviceName -match "Speakers|æ‰¬å£°å™¨") {
    $deviceType = "ç³»ç»Ÿè‡ªå¸¦æ‰¬å£°å™¨"
    & "nircmd.exe" mutesysvolume 1
} else {
    $deviceType = "å…¶ä»–è®¾å¤‡"
    & "nircmd.exe" mutesysvolume 1
}

# è¾“å‡ºå½“å‰ä½¿ç”¨çš„è®¾å¤‡åç§°å’Œç±»å‹
Write-Output "å½“å‰ä½¿ç”¨çš„è®¾å¤‡åç§°: $deviceName"
Write-Output "å½“å‰ä½¿ç”¨çš„è®¾å¤‡ç±»å‹: $deviceType"
```

</details>


## è¿›ä¸€æ­¥ä¼˜åŒ–

èµ°åˆ°è¿™ä¸€æ­¥å…¶å®å·²ç»å®Œæˆäº† 90%ï¼Œå¯ä»¥è¯•è¯•æ–­å¼€è€³æœºè¿ä¸Šè€³æœºæ•ˆæœï¼Œæˆ–è€…ï¼Œç›´æ¥æ‰“å¼€ã€Œä»»åŠ¡è®¡åˆ’ç¨‹åºã€è¿è¡Œå®ƒ

![alt text](image-1.png)

### éšè—æ¡†å£

å¦‚æœä½ è¯•è¿‡å°±ä¼šå‘ç°ç¬¬ä¸€ç‚¹é—®é¢˜ã€ä»»åŠ¡æ‰§è¡Œæ—¶ä¼šå‡ºç° Powershell æ‰§è¡Œçš„çª—å£ï¼Œä½†æ˜¯åˆå› ä¸ºæ‰§è¡Œå¤ªå¿«ï¼Œçª—å£ä¸€é—ªè€Œè¿‡ï¼Œè§†è§‰æ•ˆæœä¸å¤ªä¼˜é›…

æŠŠæ‰§è¡Œçš„ç”¨æˆ·æ¢æˆ SYSTEM å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™ä¸ª SYSTEM æ˜¯ Windows ä¸­è‡³é«˜æ— ä¸Šçš„èº«ä»½ï¼ŒæŒæ¡æœ€é‡è¦çš„ç³»ç»Ÿä»»åŠ¡çš„æƒé™ï¼Œæ­£å¸¸ç”¨æˆ·æ— æ³•ç™»å½•ï¼Œä¼¼ä¹è¿ç”¨æˆ·ç•Œé¢éƒ½æ²¡æœ‰ã€‚åœ¨ä»»åŠ¡è®¡åˆ’ç¨‹åºä¸­æ‰¾åˆ°åˆšæ‰æ–°å»ºçš„ä»»åŠ¡ï¼Œè®¾ç½®å±æ€§ `å¸¸è§„=>å®‰å…¨é€‰é¡¹=>æ›´æ”¹ç”¨æˆ·æˆ–ç»„=>è¾“å…¥SYSTEMï¼Œç‚¹å‡»æ£€æŸ¥åç§°` æˆåŠŸã€‚

![alt text](image-2.png)

ä½†æ˜¯ç°åœ¨ç›´æ¥è¿è¡Œçš„è¯ä¼šå¤±è´¥ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œç»å¸¸è‡ªå·±æ‰“å°æ—¥å¿—çš„æœ‹å‹å°±ä¼šå‘ç°ï¼ŒåŸæ¥æ˜¯æŠ¥é”™è¯´ç¨‹åºæ‰¾ä¸åˆ° `Get-AudioDevice`

é‚£ç»™å®ƒè£…ä¸€ä¸ªå‘—ï¼Œç”¨å·¥å…·åŒ… pstools ç™»å½• SYSTEM [ç‚¹æˆ‘ä¸‹è½½](https://download.sysinternals.com/files/PSTools.zip)ï¼Œé‡æ–°å®‰è£…æ¨¡å—ï¼Œé—®é¢˜è§£å†³ï¼Œè¿è¡Œä»»åŠ¡ä¹Ÿæ²¡æœ‰çª—å£

```bash
psexec -i -s powershell.exe
Install-Module -Name AudioDeviceCmdlets -Force
```

### ç”µæºæ¡ä»¶è®¾ç½®

å¦ä¸€ä¸ªé—®é¢˜æ˜¯é‡ä¸­ä¹‹é‡ï¼Œç‚¹å¼€åˆšæ‰æ–°å»ºä»»åŠ¡çš„å±æ€§è®¾ç½®ï¼Œé€‰æ‹©æ¡ä»¶ä¸­æœ‰ä¸€ä¸ªã€Œç”µæºã€ï¼Œè¯·ä¸€å®šå…³é—­

> åŒå­¦ï¼Œä½ ä¹Ÿä¸æƒ³å› ä¸ºæ²¡æ’ç”µæºå†é‡åˆ°é‚£ç§æƒ…æ™¯å§ï¼ˆ

![](../meme/anon.jpg)

![alt text](image-3.png)


## å»¶ä¼¸

å†™çš„æ—¶å€™æ‰¾èµ„æ–™çœ‹åˆ°ä¸€ç¯‡æ ¹æ® Wi-Fi åˆ¤æ–­é™éŸ³æ¡ä»¶çš„ç±»ä¼¼æ–‡ç« : [Windows è¿æ¥ç‰¹å®š WiFi è‡ªåŠ¨é™éŸ³](https://sspai.com/post/84576)

> ç¬”è®°æœ¬å‘¨æœ«å¸¦å›å®¶ï¼Œå‘¨ä¸€æ‹¿åˆ°åŠå…¬å®¤ï¼Œæ‰“å¼€ PotPlayer åˆšæƒ³æ‘¸æ‘¸é±¼ï¼Œå°ç”µå½±çš„å£°éŸ³å°±è‡ªåŠ¨æ’­æ”¾å‡ºæ¥ğŸ˜‚ï¼Œåˆ©ç”¨ Windows è®¡åˆ’ä»»åŠ¡å’Œ NirCmd å‘½ä»¤è¡Œå°ç¨‹åºå¸®ä½ è¿æ¥åŠå…¬å®¤ WiFi æ—¶è‡ªåŠ¨é™éŸ³

åŸç†å·®ä¸å¤šï¼Œè¿™é‡Œè®°ä¸€ä¸‹è§¦å‘å™¨è®¾ç½®ï¼šé€‰æ‹©è‡ªå®šä¹‰

- äº‹ä»¶æ—¥å¿—ï¼šåº”ç”¨ç¨‹åºå’ŒæœåŠ¡æ—¥å¿— - Microsoft - Windows - WLAN - AutoConfig/Operationalï¼›
- äº‹ä»¶æ¥æºï¼š WLAN - AutoConfigï¼›
- äº‹ä»¶IDï¼š8001ï¼›
- ä»»åŠ¡ç±»åˆ«ï¼šAcmConnectionï¼›

xml é‡Œæ·»åŠ å…·ä½“çš„ Wi-Fi å

```xml
<QueryList>
 <Query Id="0" Path="Microsoft-Windows-WLAN-AutoConfig/Operational">
   <Select Path="Microsoft-Windows-WLAN-AutoConfig/Operational">*[System[Provider[@Name='Microsoft-Windows-WLAN-AutoConfig'] and Task = 24010 and (EventID=8001)]]and *[EventData[Data[@Name='SSID']='ä½ çš„WiFi ssid']] </Select>
 </Query>
</QueryList>
```

## å‚è€ƒèµ„æ–™

- [How to use PowerShell to modify sound volume? Solved - Windows 10 Forums](https://www.tenforums.com/sound-audio/167181-how-use-powershell-modify-sound-volume.html)
- [How to use Windows (10) task planer to use Bluetooth Headsets with VoicemeeterB - VB-Audio's Forums](https://forum.vb-audio.com/viewtopic.php?t=590)